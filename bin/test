#!/usr/bin/env node

'use strict';

var Jasmine = require('jasmine');
var jasmine = new Jasmine();
var path = require('path');

if (process.env.RUNNER === 'CI') {
  var krustyJasmineReporter = require('krusty-jasmine-reporter');

  var junitReporter = new krustyJasmineReporter.KrustyJasmineJUnitReporter({
    specTimer: new jasmine.jasmine.Timer(),
    JUnitReportSavePath: process.env.SAVE_PATH || './',
    JUnitReportFilePrefix: process.env.FILE_PREFIX || 'math-results-' +  process.version,
    JUnitReportSuiteName: 'Math Reports',
    JUnitReportPackageName: 'Math Reports'
  });

  jasmine.jasmine.getEnv().addReporter(junitReporter);
}

require('babel-register')({
  ignore: function ignore (filename) {
    var p = filename.slice(path.dirname(__dirname).length + 1);

    var keep = [
      'node_modules/intel-fp/index.js',
      'test/',
      'math.js'
    ];

    var foundMatch = keep.some(function  (s) {
      return p.search(s) === 0;
    });

    return !foundMatch;
  }
});

jasmine.loadConfig({
  spec_dir: 'test',
  spec_files: [
    '**/*.js'
  ]
});

jasmine.execute();



